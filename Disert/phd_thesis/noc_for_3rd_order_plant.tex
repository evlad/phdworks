% -*-coding: cp1251;-*-

%\section{Пример с линейным объектом третьего порядка}\label{plant_3rd_order}

Проиллюстрируем использование методик замены ПИД регулятора на
нейросетевой (глава~\ref{linear_to_neural}) и синтеза нейросетевого
оптимального регулятора на примере объекта 3-го порядка, управляемого
ПИД регулятором.

Объект задан следующей передаточной функцией:
\begin{equation}\label{eq:3rd_order_step_plant}
\begin{array}{rcl}
P^*(z) & = & \displaystyle\frac{z^3-0.1}{z^3-1.4z^2+1.06z-0.464}\\
       & = & \displaystyle\frac{z^3-0.1}{(z-0.8)(z^2-0.06z+0.58)}\\
\end{array}
\end{equation}

\noindent с одним действительным $z_1=0.8$ и двумя комплексными
корнями $z_{2,3}=0.3\pm 0.7i$.  ПИД регулятор описывается формулой:
\begin{equation}\label{eq:3rd_order_step_pid}
C_{PID}^*(z)=K_p\Bigl(1+\displaystyle\frac{z}{T_i(z-1)}+\displaystyle\frac{z^2-2z+1}{T_d(z^2-z)}\Bigr)
\end{equation}

\noindent где параметры $K_p=0.01$, $T_i=0.05$, $T_d=0.1$ подобраны
вручную для минимизации времени переходного процесса и величины
перерегулирования.  Реакция системы управления на ступенчатую уставку
приведена на~\figref{fig:3rd_order_step_response}.

\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{3rd_order_step_response_ru}
\caption{Реакция контура управления с ПИД регулятором и объектом 3-го порядка на ступенчатую уставку.}\label{fig:3rd_order_step_response}
\end{figure}

Задача управления ставится для стохастической уставки, формирующий
фильтр которой представлен формулой
$R^*(z)=\displaystyle\frac{3z}{z-0.7}$, а нормально распределенная
помеха имеет формирующий фильтр $N^*(z)=0.07$.  В таких условиях на
выборке длиной 2000 отсчетов ПИД регулятор обеспечил
среднеквадратическую ошибку управления $\MSE=4.16$ с максимальной
ошибкой $|e|_{max}=15.58$.

Используя рекомендации из главы~\ref{linear_to_neural}, для
нейросетевого регулятора была взята архитектура $\NN^p_{r+e,5.3.1}(r_k,e_k)$
(\figref{fig:3rd_order_nn_arch}а).  Нейросетевой регулятор был обучен
по данным наблюдений за исходным ПИД регулятором.  По результатам
обучения НС--Р был помещен в контур управления на замену ПИД.  При
этом СКО управления составила $\MSE=2.78$, а максимальная ошибка ---
$|e|_{max}=23.01$.

Архитектура модели объекта
$\NN^o_{1+3,7,4,1}(u_k,y_k,y_{k-1},y_{k-2})$ была взята сообразно
представленным выше рекомендациям (\figref{fig:3rd_order_nn_arch}б).
На~\figref{fig:3rd_order_nnp_result} представлены наблюдаемый выход
объекта и обученной нейросетевой модели.

\begin{figure}
\centering
\begin{tabular}{cc}
  \includegraphics[width=0.45\textwidth]{3rd_order_nnc_arch} &
  \includegraphics[width=0.45\textwidth]{3rd_order_nnp_arch} \\
  а) & б) \\
\end{tabular}
\caption{Архитектуры нейросетевого регулятора с входами $r_k,e_k$ (а) и модели с входами $u_k,y_k,y_{k-1},y_{k-2}$ (б).}\label{fig:3rd_order_nn_arch}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{3rd_order_nnp_result_ru}
\caption{Графики наблюдаемого выхода объекта и предсказанного по нейросетевой модели.}\label{fig:3rd_order_nnp_result}
\end{figure}

Обучение нейросетевого регулятора с целью минимизации
среднеквадратической ошибки в контуре управления обеспечило по
окончании процесса СКО управления $\MSE=2.58$ и максимальную ошибку
$|e|_{max}=9.51$.  Таким образом, применение нейросетевого
оптимального регулятора дало по сравнению с исходным ПИД регулятором
уменьшение СКО управления на 37\%, а максимальной ошибки --- на 39\%.
