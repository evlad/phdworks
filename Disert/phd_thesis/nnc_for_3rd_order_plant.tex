% -*-coding: cp1251;-*-

%\section{Пример с линейным объектом третьего порядка}\label{plant_3rd_order}

Проиллюстрируем использование методики замены ПИД регулятора на
нейросетевой на примере контура с объектом 3-го порядка, управляемого
ПИД регулятором.

Объект задан следующей передаточной функцией:
\begin{equation}\label{eq:3rd_order_step_plant}
\begin{array}{rcl}
P^*(z) & = & \displaystyle\frac{z^3-0.1}{z^3-1.4z^2+1.06z-0.464}\\
       & = & \displaystyle\frac{z^3-0.1}{(z-0.8)(z^2-0.06z+0.58)}\\
\end{array}
\end{equation}

\noindent с одним действительным $z_1=0.8$ и двумя комплексными
корнями $z_{2,3}=0.3\pm 0.7i$.  ПИД регулятор описывается формулой:
\begin{equation}\label{eq:3rd_order_step_pid}
C_{PID}^*(z)=K_p\Bigl(1+\displaystyle\frac{z}{T_i(z-1)}+\displaystyle\frac{z^2-2z+1}{T_d(z^2-z)}\Bigr)
\end{equation}

\noindent где параметры $K_p=0.01$, $T_i=0.05$, $T_d=0.1$ подобраны
вручную для минимизации времени переходного процесса и величины
перерегулирования.  Реакция исходной системы управления на ступенчатую
уставку приведена на~\figref{fig:3rd_order_step_response}.

\begin{figure}[h]
\centering
\includegraphics[width=0.65\textwidth]{3rd_order_step_response_ru}
\caption{Реакция контура управления с ПИД регулятором и объектом 3-го порядка на ступенчатую уставку.}\label{fig:3rd_order_step_response}
\end{figure}

Используя разработанные ранее в этой главе рекомендации, для
нейросетевого регулятора была взята архитектура
$\NN^p_{r+e,5.3.1}(r_k,e_k)$ (\figref{fig:3rd_order_nn_arch}).
Нейросетевой регулятор был обучен по данным наблюдений за исходным ПИД
регулятором со случайной уставкой, формирующий фильтр которой
представлен формулой $R^*(z)=\displaystyle\frac{3z}{z-0.7}$, а
нормально распределенная помеха имела формирующий фильтр
$N^*(z)=0.07$.  На обучающей выборке длиной 2000 отсчетов амплитуда
уставки изменялась в диапазоне от $-20$ до $15$, а помехи --- в
диапазоне от $-0.25$ до $0.31$.  На этой выборке ПИД регулятор
обеспечил среднеквадратическую ошибку управления $\MSE=4.16$ с
максимальной ошибкой $|e|_{max}=15.58$.

По результатам обучения НС--Р был помещен в контур управления на
замену ПИД.  При этом СКО управления составила $\MSE=2.78$, а
максимальная ошибка --- $|e|_{max}=10.24$.  Таким образом, применение
нейросетевого регулятора по сравнению с исходным ПИД дало уменьшение
СКО управления на 33\%, а максимальная ошибка уменьшилась на 34\%.
На \figref{fig:3rd_nnc_step_response} показана реакция системы под
управлением НС--Р на ступенчатое возмущение.

\begin{figure}[h]
\centering
\includegraphics[width=0.6\textwidth]{3rd_order_nnc_arch}
\caption{Архитектура нейросетевого регулятора с входами $r_k,e_k$.}\label{fig:3rd_order_nn_arch}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.65\textwidth]{3rd_nnc_step_response_ru}
\caption{Реакция контура управления с НС--Р и объектом 3-го порядка на ступенчатую уставку.}\label{fig:3rd_nnc_step_response}
\end{figure}

Описанный пример показывает, что замена ПИД регулятора в системе с
объектом управления 3-го порядка на нейросетевой регулятор,
выполненная по описанной ранее методике, обеспечивает устойчивость
управления в контуре и уменьшение как времени переходных процессов,
так и максимального перерегулирования.  По той же методике проводились
эксперименты с объектами более высоких порядков, показавшие
аналогичные результаты.
